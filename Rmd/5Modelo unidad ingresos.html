<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.165">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andrés Gutiérrez - Stalyn Guerrero">

<title>Estimación del ingreso medio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="5Modelo unidad ingresos_files/libs/clipboard/clipboard.min.js"></script>
<script src="5Modelo unidad ingresos_files/libs/quarto-html/quarto.js"></script>
<script src="5Modelo unidad ingresos_files/libs/quarto-html/popper.min.js"></script>
<script src="5Modelo unidad ingresos_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="5Modelo unidad ingresos_files/libs/quarto-html/anchor.min.js"></script>
<link href="5Modelo unidad ingresos_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="5Modelo unidad ingresos_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="5Modelo unidad ingresos_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="5Modelo unidad ingresos_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="5Modelo unidad ingresos_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="5Modelo unidad ingresos_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="5Modelo unidad ingresos_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Estimación del ingreso medio</h1>
<p class="subtitle lead">CEPAL - División de Estadísticas Sociales</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Andrés Gutiérrez - Stalyn Guerrero </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<p>Uno de los primeros problemas a los que debemos enfrentarnos es la estimación del ingreso medio, la cual en una variable no simétrica que toma valores en los positivos. Sin embargo, empleando los métodos Bayesiano es posible obtener estimaciones de esta sin realizar una transformación</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="5Modelo-unidad-ingresos_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Distribución del ingreso medio por segmento en Montevideo</figcaption><p></p>
</figure>
</div>
</div>
</div>
<section id="modelo-bayesiano." class="level2">
<h2 class="anchored" data-anchor-id="modelo-bayesiano.">Modelo bayesiano.</h2>
<p>Para realizar la predicción del ingreso medio en segmento no observados se asume que:</p>
<p><span class="math display">\[
\begin{eqnarray*}
Y_{di} &amp;\sim &amp; N\left(\mu_{di},\sigma_y^{2}\right)\\
\mu_{di}&amp;=&amp;\boldsymbol{X}_{di}^{T}\boldsymbol{\beta}+u_{d}+e_{di}
\end{eqnarray*}
\]</span></p>
<p>Donde <span class="math inline">\(Y_{di}\)</span> representa el ingreso medio de la <span class="math inline">\(i-ésima\)</span> persona en el <span class="math inline">\(d-ésimo\)</span> domino, <span class="math inline">\(\boldsymbol{X}\)</span> es la información disponible para la <span class="math inline">\(i-ésima\)</span> persona del <span class="math inline">\(d-ésimo\)</span> domino, <span class="math inline">\(\boldsymbol{\beta}\)</span> es el vector de parámetros <span class="math inline">\(u_d\)</span> es el efecto introducido por el <span class="math inline">\(d-ésimo\)</span> dominio y <span class="math inline">\(e_{di}\)</span> es el error de estimación para la <span class="math inline">\(i-ésima\)</span> personas del <span class="math inline">\(d-ésimo\)</span> dominio.</p>
<p>Note, que <span class="math inline">\(u_{d}\sim N\left(0,\sigma_{u}\right)\)</span> y <span class="math inline">\(e_{di}\sim N\left(0,\sigma_{e}^{2}\right)\)</span>.</p>
<p>Para este caso se asumen las distribuciones previas</p>
<p><span class="math display">\[
\begin{eqnarray*}
\beta_k &amp; \sim   &amp; N(\mu_0, \tau^2_0)\\
\sigma^2_y &amp;\sim &amp; Inversa-Gamma(\alpha_1,\alpha_2)
\end{eqnarray*}
\]</span> las cuales se toman no informativas.</p>
<p>A continuación se muestra el proceso realizado para la obtención de la predicción del ingreso medio en dominios no observados.</p>
</section>
<section id="proceso-de-estimación-en-r" class="level2">
<h2 class="anchored" data-anchor-id="proceso-de-estimación-en-r">Proceso de estimación en <code>R</code></h2>
<p>Para desarrollar la metodología se hace uso de las siguientes librerías.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span><span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Interprete de STAN en R</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstanarm)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Manejo de bases de datos.</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráficas de los modelos. </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Organizar la presentación de las tablas</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(printr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Un conjunto de funciones desarrolladas para realizar de forma simplificada los procesos están consignadas en la siguiente rutina.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"0Funciones/funciones_mrp.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Entre las funciones incluidas en el archivo encuentra</p>
<ul>
<li><p><em>plot_interaction</em>: Esta crea un diagrama de lineas donde se estudia la interacción entre las variables, en el caso de presentar un traslape de las lineas se recomienda incluir el interacción en el modelo.</p></li>
<li><p><em>Plot_Compare</em> Puesto que es necesario realizar una homologar la información del censo y la encuesta es conveniente llevar a cabo una validación de las variables que han sido homologadas, por tanto, se espera que las proporciones resultantes del censo y la encuesta estén cercanas entre sí.</p></li>
<li><p><em>Aux_Agregado</em>: Esta es función permite obtener estimaciones a diferentes niveles de agregación, toma mucha relevancia cuando se realiza un proceso repetitivo.</p></li>
</ul>
<p><strong>Las funciones están diseñada específicamente para este proceso</strong></p>
<section id="encuesta-de-hogares" class="level3">
<h3 class="anchored" data-anchor-id="encuesta-de-hogares">Encuesta de hogares</h3>
<p>Los datos empleados en esta ocasión corresponden a la ultima encuesta de hogares, la cual ha sido estandarizada por <em>CEPAL</em> y se encuentra disponible en <em>BADEHOG</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>encuesta_mrp <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"../Data/encuesta_Montevideo.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La base de datos de la encuesta tiene la siguientes columnas:</p>
<ul>
<li><p><em>depto</em>: Corresponde al código asignado a la segunda división administrativa del país.</p></li>
<li><p><em>mpio</em>: Corresponde al código asignado a la tercera división administrativa del país.</p></li>
<li><pre><code>*lp* y *li* lineas de pobreza y pobreza extrema definidas por CEPAL. </code></pre></li>
<li><pre><code>*área* división geográfica (Urbano y Rural). </code></pre></li>
<li><pre><code>*sexo* Hombre y Mujer. </code></pre></li>
<li><pre><code>*etnia* En estas variable se definen tres grupos:  afrodescendientes, indígenas y Otros. </code></pre></li>
<li><pre><code>Años de escolaridad (*anoest*) </code></pre></li>
<li><pre><code>Rangos de edad (*edad*) </code></pre></li>
<li><pre><code>Factor de expansión por persona (*fep*)</code></pre></li>
</ul>
<div class="cell">
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> depto </th>
   <th style="text-align:left;"> mpio </th>
   <th style="text-align:left;"> segm </th>
   <th style="text-align:right;"> ingreso </th>
   <th style="text-align:right;"> lp </th>
   <th style="text-align:right;"> li </th>
   <th style="text-align:left;"> area </th>
   <th style="text-align:left;"> sexo </th>
   <th style="text-align:left;"> anoest </th>
   <th style="text-align:left;"> edad </th>
   <th style="text-align:left;"> etnia </th>
   <th style="text-align:right;"> fep </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0121 </td>
   <td style="text-align:left;"> 0121132 </td>
   <td style="text-align:right;"> 13000.00 </td>
   <td style="text-align:right;"> 6503.53 </td>
   <td style="text-align:right;"> 3064.55 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 27.6806 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0105 </td>
   <td style="text-align:left;"> 0105101 </td>
   <td style="text-align:right;"> 79541.67 </td>
   <td style="text-align:right;"> 6503.53 </td>
   <td style="text-align:right;"> 3064.55 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 5 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 36.6667 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0111 </td>
   <td style="text-align:left;"> 0111207 </td>
   <td style="text-align:right;"> 15081.25 </td>
   <td style="text-align:right;"> 6503.53 </td>
   <td style="text-align:right;"> 3064.55 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 23.1001 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0111 </td>
   <td style="text-align:left;"> 0111211 </td>
   <td style="text-align:right;"> 43200.00 </td>
   <td style="text-align:right;"> 6503.53 </td>
   <td style="text-align:right;"> 3064.55 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 5 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:right;"> 33.7500 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0111 </td>
   <td style="text-align:left;"> 0111002 </td>
   <td style="text-align:right;"> 31000.00 </td>
   <td style="text-align:right;"> 6503.53 </td>
   <td style="text-align:right;"> 3064.55 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 5 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 14.7685 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0121 </td>
   <td style="text-align:left;"> 0121019 </td>
   <td style="text-align:right;"> 22250.00 </td>
   <td style="text-align:right;"> 6503.53 </td>
   <td style="text-align:right;"> 3064.55 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 20.4917 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0110 </td>
   <td style="text-align:left;"> 0110126 </td>
   <td style="text-align:right;"> 48666.67 </td>
   <td style="text-align:right;"> 6503.53 </td>
   <td style="text-align:right;"> 3064.55 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> 5 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 24.4179 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0110 </td>
   <td style="text-align:left;"> 0110126 </td>
   <td style="text-align:right;"> 48666.67 </td>
   <td style="text-align:right;"> 6503.53 </td>
   <td style="text-align:right;"> 3064.55 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 24.4179 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0106 </td>
   <td style="text-align:left;"> 0106103 </td>
   <td style="text-align:right;"> 43911.11 </td>
   <td style="text-align:right;"> 6503.53 </td>
   <td style="text-align:right;"> 3064.55 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 24.2743 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0116 </td>
   <td style="text-align:left;"> 0116136 </td>
   <td style="text-align:right;"> 16613.42 </td>
   <td style="text-align:right;"> 6503.53 </td>
   <td style="text-align:right;"> 3064.55 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 32.0664 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Ahora, inspeccionamos el comportamiento de la variable de interés:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> encuesta_mrp, <span class="fu">aes</span>(<span class="at">x =</span> ingreso)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>(),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">250000</span>)) <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="5Modelo-unidad-ingresos_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Distribuición del ingreso de las personas encuestadas</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La información auxiliar disponible ha sido extraída del censo (tasa de desocupación) e imágenes satelitales (luces nocturnas, uso del suelo urbano y uso del suelo cultivos)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>tasa_desocupados <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"../Data/tasa_desocupacion_seccion.rds"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>statelevel_predictors_df <span class="ot">&lt;-</span> tasa_desocupados</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> depto </th>
   <th style="text-align:left;"> segm </th>
   <th style="text-align:left;"> mpio </th>
   <th style="text-align:right;"> tasa_desocupacion </th>
   <th style="text-align:right;"> F182013_stable_lights </th>
   <th style="text-align:right;"> X2016_crops.coverfraction </th>
   <th style="text-align:right;"> X2016_urban.coverfraction </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0101001 </td>
   <td style="text-align:left;"> 0101 </td>
   <td style="text-align:right;"> 0.0822 </td>
   <td style="text-align:right;"> 9.1412 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 14.8078 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0101002 </td>
   <td style="text-align:left;"> 0101 </td>
   <td style="text-align:right;"> 0.0607 </td>
   <td style="text-align:right;"> 12.1059 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 20.4549 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0101003 </td>
   <td style="text-align:left;"> 0101 </td>
   <td style="text-align:right;"> 0.0426 </td>
   <td style="text-align:right;"> 7.7255 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 12.1412 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0101104 </td>
   <td style="text-align:left;"> 0101 </td>
   <td style="text-align:right;"> 0.0508 </td>
   <td style="text-align:right;"> 4.6941 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 6.7451 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0101105 </td>
   <td style="text-align:left;"> 0101 </td>
   <td style="text-align:right;"> 0.0701 </td>
   <td style="text-align:right;"> 2.9255 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 4.7216 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0101204 </td>
   <td style="text-align:left;"> 0101 </td>
   <td style="text-align:right;"> 0.0844 </td>
   <td style="text-align:right;"> 4.9412 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 7.6392 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0101205 </td>
   <td style="text-align:left;"> 0101 </td>
   <td style="text-align:right;"> 0.0391 </td>
   <td style="text-align:right;"> 2.9647 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 9.7725 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0102001 </td>
   <td style="text-align:left;"> 0102 </td>
   <td style="text-align:right;"> 0.0618 </td>
   <td style="text-align:right;"> 13.8275 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 4.0000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0102003 </td>
   <td style="text-align:left;"> 0102 </td>
   <td style="text-align:right;"> 0.0722 </td>
   <td style="text-align:right;"> 6.1255 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 7.7333 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0102004 </td>
   <td style="text-align:left;"> 0102 </td>
   <td style="text-align:right;"> 0.0621 </td>
   <td style="text-align:right;"> 5.2588 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 6.8392 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<ul>
<li><p><em>tasa_desocupacion</em>: Información extraída del último censo del país.</p></li>
<li><p><em>F182013_stable_lights</em>, <em>X2016_crops.coverfraction</em> y <em>X2016_urban.coverfraction</em> información satelital extraída con google earth engine operando desde <code>R</code>.</p></li>
</ul>
</section>
<section id="niveles-de-agregación-para-colapsar-encuesta" class="level3">
<h3 class="anchored" data-anchor-id="niveles-de-agregación-para-colapsar-encuesta">Niveles de agregación para colapsar encuesta</h3>
<p>Después de realizar una investigación en la literatura especializada y realizar estudios de simulación fue posible evidenciar que las predicciones obtenidas con la muestra sin agregar y la muestra agregada convergen a la media del dominio. Sin embargo, el realizar estas estimaciones con la muestra agregada reduce el tiempo computacional necesario para la convergencia de las cadenas MCMC. Con esto en mente se se realiza la identificación de las variables por las cuales se agregará la encuesta.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>byAgrega <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"depto"</span>, <span class="st">"mpio"</span>,  <span class="st">"segm"</span>, <span class="st">"area"</span>,   <span class="st">"sexo"</span>,   <span class="st">"anoest"</span>, <span class="st">"edad"</span>,   <span class="st">"etnia"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creando-base-con-la-encuesta-agregada" class="level3">
<h3 class="anchored" data-anchor-id="creando-base-con-la-encuesta-agregada">Creando base con la encuesta agregada</h3>
<p>El resultado de agregar la base de dato se muestra a continuación:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>encuesta_df_agg <span class="ot">&lt;-</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  encuesta_mrp <span class="sc">%&gt;%</span>                    <span class="co"># Encuesta  </span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by_at</span>(<span class="fu">all_of</span>(byAgrega)) <span class="sc">%&gt;%</span>   <span class="co"># Agrupar por el listado de variables</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),                  <span class="co"># Número de observaciones</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ingreso medio de las personas con características similares.           </span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">ingreso =</span> <span class="fu">mean</span>(ingreso), </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span>     </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))                    <span class="co"># Ordenar la base.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La tabla obtenida es la siguiente:</p>
<div class="cell">
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> depto </th>
   <th style="text-align:left;"> mpio </th>
   <th style="text-align:left;"> segm </th>
   <th style="text-align:left;"> area </th>
   <th style="text-align:left;"> sexo </th>
   <th style="text-align:left;"> anoest </th>
   <th style="text-align:left;"> edad </th>
   <th style="text-align:left;"> etnia </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> ingreso </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0113 </td>
   <td style="text-align:left;"> 0113240 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 32 </td>
   <td style="text-align:right;"> 20712.48 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0111 </td>
   <td style="text-align:left;"> 0111135 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 29 </td>
   <td style="text-align:right;"> 11840.72 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0111 </td>
   <td style="text-align:left;"> 0111135 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 29 </td>
   <td style="text-align:right;"> 16214.65 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0110 </td>
   <td style="text-align:left;"> 0110059 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 27 </td>
   <td style="text-align:right;"> 98790.26 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0111 </td>
   <td style="text-align:left;"> 0111135 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 27 </td>
   <td style="text-align:right;"> 11892.03 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0110 </td>
   <td style="text-align:left;"> 0110064 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 26 </td>
   <td style="text-align:right;"> 111563.94 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0113 </td>
   <td style="text-align:left;"> 0113135 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 26 </td>
   <td style="text-align:right;"> 11336.13 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0110 </td>
   <td style="text-align:left;"> 0110148 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 24 </td>
   <td style="text-align:right;"> 33146.02 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0115 </td>
   <td style="text-align:left;"> 0115107 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 24 </td>
   <td style="text-align:right;"> 36903.93 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0118 </td>
   <td style="text-align:left;"> 0118119 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 24 </td>
   <td style="text-align:right;"> 82405.43 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>El paso a seguir es unificar las tablas creadas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>encuesta_df_agg <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(encuesta_df_agg, statelevel_predictors_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="definiendo-el-modelo-multinivel." class="level3">
<h3 class="anchored" data-anchor-id="definiendo-el-modelo-multinivel.">Definiendo el modelo multinivel.</h3>
<p>Después de haber ordenado la encuesta, podemos pasar a la definición del modelo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">MC.cores=</span>parallel<span class="sc">::</span><span class="fu">detectCores</span>()) <span class="co"># Permite procesar en paralelo. </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">stan_lmer</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  ingreso <span class="sc">~</span>                               <span class="co"># Ingreso medio (Y)</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> segm) <span class="sc">+</span>                          <span class="co"># Efecto aleatorio (ud)</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>     edad <span class="sc">+</span>                               <span class="co"># Efecto fijo (Variables X)</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    sexo  <span class="sc">+</span> </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    tasa_desocupacion <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    F182013_stable_lights <span class="sc">+</span> </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    X2016_crops.coverfraction <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    X2016_urban.coverfraction ,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">weights =</span> n,            <span class="co"># Número de observaciones. </span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> encuesta_df_agg, <span class="co"># Encuesta agregada </span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">TRUE</span>,         <span class="co"># Muestre el avance del proceso</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">chains =</span> <span class="dv">4</span>,             <span class="co"># Número de cadenas.</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">iter =</span> <span class="dv">1000</span>              <span class="co"># Número de realizaciones de la cadena</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(fit, <span class="at">file =</span> <span class="st">"../Data/fit_ingresos.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Después de esperar un tiempo prudente se obtiene el siguiente modelo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"../Data/fit_ingresos.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> (Intercept) </th>
   <th style="text-align:right;"> edad2 </th>
   <th style="text-align:right;"> edad3 </th>
   <th style="text-align:right;"> edad4 </th>
   <th style="text-align:right;"> edad5 </th>
   <th style="text-align:right;"> sexo2 </th>
   <th style="text-align:right;"> tasa_desocupacion </th>
   <th style="text-align:right;"> F182013_stable_lights </th>
   <th style="text-align:right;"> X2016_crops.coverfraction </th>
   <th style="text-align:right;"> X2016_urban.coverfraction </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0101001 </td>
   <td style="text-align:right;"> 55992.33 </td>
   <td style="text-align:right;"> 3625.283 </td>
   <td style="text-align:right;"> 6976.698 </td>
   <td style="text-align:right;"> 13453.93 </td>
   <td style="text-align:right;"> 18159.29 </td>
   <td style="text-align:right;"> -777.4026 </td>
   <td style="text-align:right;"> -331086.4 </td>
   <td style="text-align:right;"> -87.7841 </td>
   <td style="text-align:right;"> -27.8664 </td>
   <td style="text-align:right;"> -9.4567 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0101002 </td>
   <td style="text-align:right;"> 70230.05 </td>
   <td style="text-align:right;"> 3625.283 </td>
   <td style="text-align:right;"> 6976.698 </td>
   <td style="text-align:right;"> 13453.93 </td>
   <td style="text-align:right;"> 18159.29 </td>
   <td style="text-align:right;"> -777.4026 </td>
   <td style="text-align:right;"> -331086.4 </td>
   <td style="text-align:right;"> -87.7841 </td>
   <td style="text-align:right;"> -27.8664 </td>
   <td style="text-align:right;"> -9.4567 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0101003 </td>
   <td style="text-align:right;"> 93939.36 </td>
   <td style="text-align:right;"> 3625.283 </td>
   <td style="text-align:right;"> 6976.698 </td>
   <td style="text-align:right;"> 13453.93 </td>
   <td style="text-align:right;"> 18159.29 </td>
   <td style="text-align:right;"> -777.4026 </td>
   <td style="text-align:right;"> -331086.4 </td>
   <td style="text-align:right;"> -87.7841 </td>
   <td style="text-align:right;"> -27.8664 </td>
   <td style="text-align:right;"> -9.4567 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0101104 </td>
   <td style="text-align:right;"> 41531.53 </td>
   <td style="text-align:right;"> 3625.283 </td>
   <td style="text-align:right;"> 6976.698 </td>
   <td style="text-align:right;"> 13453.93 </td>
   <td style="text-align:right;"> 18159.29 </td>
   <td style="text-align:right;"> -777.4026 </td>
   <td style="text-align:right;"> -331086.4 </td>
   <td style="text-align:right;"> -87.7841 </td>
   <td style="text-align:right;"> -27.8664 </td>
   <td style="text-align:right;"> -9.4567 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0101105 </td>
   <td style="text-align:right;"> 74578.12 </td>
   <td style="text-align:right;"> 3625.283 </td>
   <td style="text-align:right;"> 6976.698 </td>
   <td style="text-align:right;"> 13453.93 </td>
   <td style="text-align:right;"> 18159.29 </td>
   <td style="text-align:right;"> -777.4026 </td>
   <td style="text-align:right;"> -331086.4 </td>
   <td style="text-align:right;"> -87.7841 </td>
   <td style="text-align:right;"> -27.8664 </td>
   <td style="text-align:right;"> -9.4567 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0101204 </td>
   <td style="text-align:right;"> 52238.73 </td>
   <td style="text-align:right;"> 3625.283 </td>
   <td style="text-align:right;"> 6976.698 </td>
   <td style="text-align:right;"> 13453.93 </td>
   <td style="text-align:right;"> 18159.29 </td>
   <td style="text-align:right;"> -777.4026 </td>
   <td style="text-align:right;"> -331086.4 </td>
   <td style="text-align:right;"> -87.7841 </td>
   <td style="text-align:right;"> -27.8664 </td>
   <td style="text-align:right;"> -9.4567 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
</section>
<section id="proceso-de-estimación-y-predicción" class="level1">
<h1>Proceso de estimación y predicción</h1>
<p>Obtener el modelo es solo un paso más, ahora se debe realizar la predicción en el censo, el cual a sido previamente estandarizado y homologado con la encuesta.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>poststrat_df <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"../Data/censo_Montevideo.rds"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">left_join</span>(tasa_desocupados)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> depto </th>
   <th style="text-align:left;"> mpio </th>
   <th style="text-align:left;"> segm </th>
   <th style="text-align:left;"> area </th>
   <th style="text-align:left;"> sexo </th>
   <th style="text-align:left;"> edad </th>
   <th style="text-align:left;"> etnia </th>
   <th style="text-align:left;"> anoest </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> tasa_desocupacion </th>
   <th style="text-align:right;"> F182013_stable_lights </th>
   <th style="text-align:right;"> X2016_crops.coverfraction </th>
   <th style="text-align:right;"> X2016_urban.coverfraction </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0116 </td>
   <td style="text-align:left;"> 0116035 </td>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 99 </td>
   <td style="text-align:right;"> 2132 </td>
   <td style="text-align:right;"> 0.0058 </td>
   <td style="text-align:right;"> 561.0353 </td>
   <td style="text-align:right;"> 269.8980 </td>
   <td style="text-align:right;"> 139.4157 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0116 </td>
   <td style="text-align:left;"> 0116035 </td>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 99 </td>
   <td style="text-align:right;"> 1155 </td>
   <td style="text-align:right;"> 0.0058 </td>
   <td style="text-align:right;"> 561.0353 </td>
   <td style="text-align:right;"> 269.8980 </td>
   <td style="text-align:right;"> 139.4157 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0113 </td>
   <td style="text-align:left;"> 0113236 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 538 </td>
   <td style="text-align:right;"> 0.1084 </td>
   <td style="text-align:right;"> 138.0980 </td>
   <td style="text-align:right;"> 14.6784 </td>
   <td style="text-align:right;"> 164.7451 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0113 </td>
   <td style="text-align:left;"> 0113236 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 487 </td>
   <td style="text-align:right;"> 0.1084 </td>
   <td style="text-align:right;"> 138.0980 </td>
   <td style="text-align:right;"> 14.6784 </td>
   <td style="text-align:right;"> 164.7451 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0113 </td>
   <td style="text-align:left;"> 0113051 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 99 </td>
   <td style="text-align:right;"> 473 </td>
   <td style="text-align:right;"> 0.0385 </td>
   <td style="text-align:right;"> 26.3137 </td>
   <td style="text-align:right;"> 0.0000 </td>
   <td style="text-align:right;"> 52.1569 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0113 </td>
   <td style="text-align:left;"> 0113051 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 99 </td>
   <td style="text-align:right;"> 459 </td>
   <td style="text-align:right;"> 0.0385 </td>
   <td style="text-align:right;"> 26.3137 </td>
   <td style="text-align:right;"> 0.0000 </td>
   <td style="text-align:right;"> 52.1569 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0113 </td>
   <td style="text-align:left;"> 0113242 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 457 </td>
   <td style="text-align:right;"> 0.0875 </td>
   <td style="text-align:right;"> 55.3020 </td>
   <td style="text-align:right;"> 11.2588 </td>
   <td style="text-align:right;"> 57.2784 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0113 </td>
   <td style="text-align:left;"> 0113242 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 434 </td>
   <td style="text-align:right;"> 0.0875 </td>
   <td style="text-align:right;"> 55.3020 </td>
   <td style="text-align:right;"> 11.2588 </td>
   <td style="text-align:right;"> 57.2784 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0109 </td>
   <td style="text-align:left;"> 0109047 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 430 </td>
   <td style="text-align:right;"> 0.1157 </td>
   <td style="text-align:right;"> 59.7882 </td>
   <td style="text-align:right;"> 4.8941 </td>
   <td style="text-align:right;"> 72.7608 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MONTEVIDEO </td>
   <td style="text-align:left;"> 0113 </td>
   <td style="text-align:left;"> 0113236 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:right;"> 406 </td>
   <td style="text-align:right;"> 0.1084 </td>
   <td style="text-align:right;"> 138.0980 </td>
   <td style="text-align:right;"> 14.6784 </td>
   <td style="text-align:right;"> 164.7451 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Note que la información del censo esta agregada.</p>
<section id="distribución-posterior." class="level3">
<h3 class="anchored" data-anchor-id="distribución-posterior.">Distribución posterior.</h3>
<p>Para obtener una distribución posterior de cada observación se hace uso de la función <em>posterior_epred</em> de la siguiente forma.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>epred_mat <span class="ot">&lt;-</span> <span class="fu">posterior_epred</span>(fit, <span class="at">newdata =</span> poststrat_df, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(epred_mat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  2000 73731</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(poststrat_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 73731    13</code></pre>
</div>
</div>
<p>Por ser una predicción en dominios no observados, es posible obtener valores por fuera del domino de la variable (valores negativos), los cuales deben ser ajustados de forma manual.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## validación de los valores posteriores</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">as.numeric</span>(epred_mat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="5Modelo-unidad-ingresos_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">

</div>
<p>En esta ocasión tenemos que el 1.1698661% es menor que cero, por tanto los igualamos a cero.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>epred_mat[(epred_mat <span class="sc">&lt;</span> <span class="dv">0</span>)]<span class="ot">&lt;-</span><span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Como el interés es realizar comparaciones entre los países de la región se presenta la estimación del ingreso medio en términos de lineas de pobreza. Para esto procedemos así:</p>
<ul>
<li>Obteniendo las lineas de pobreza por cada post-estrato</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>(lp <span class="ot">&lt;-</span> <span class="fu">unique</span>(encuesta_mrp<span class="sc">$</span>lp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6503.53</code></pre>
</div>
</div>
<ul>
<li>Ingreso en términos de lineas de pobreza.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>epred_mat <span class="ot">&lt;-</span> epred_mat<span class="sc">/</span>lp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="estimación-del-ingreso-medio-en-montevideo" class="level2">
<h2 class="anchored" data-anchor-id="estimación-del-ingreso-medio-en-montevideo">Estimación del ingreso medio en Montevideo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>n_filtered <span class="ot">&lt;-</span> poststrat_df<span class="sc">$</span>n</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>mrp_estimates <span class="ot">&lt;-</span> epred_mat <span class="sc">%*%</span> n_filtered <span class="sc">/</span> <span class="fu">sum</span>(n_filtered)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>(temp_ing <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">mrp_estimate =</span> <span class="fu">mean</span>(mrp_estimates),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mrp_estimate_se =</span> <span class="fu">sd</span>(mrp_estimates)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table>
<thead>
<tr>
<th style="text-align:right;">
mrp_estimate
</th>
<th style="text-align:right;">
mrp_estimate_se
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
5.402399
</td>
<td style="text-align:right;">
0.136384
</td>
</tr>
</tbody>

</table>
</div>
</div>
<p>El resultado nos indica que el ingreso medio nacional es 5.4 lineas de pobreza</p>
<section id="estimación-para-mpio-0111." class="level3">
<h3 class="anchored" data-anchor-id="estimación-para-mpio-0111.">Estimación para mpio == “0111”.</h3>
<p>Es importante siempre conservar el orden de la base, dado que relación entre la predicción y el censo en uno a uno.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> poststrat_df <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">Posi =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">filter</span>(temp, mpio <span class="sc">==</span> <span class="st">"0111"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(n, Posi)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>n_filtered <span class="ot">&lt;-</span> temp<span class="sc">$</span>n</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>temp_epred_mat <span class="ot">&lt;-</span> epred_mat[, temp<span class="sc">$</span>Posi]</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimando el CME</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>mrp_estimates <span class="ot">&lt;-</span> temp_epred_mat <span class="sc">%*%</span> n_filtered <span class="sc">/</span> <span class="fu">sum</span>(n_filtered)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>(temp_ing <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">mrp_estimate =</span> <span class="fu">mean</span>(mrp_estimates),</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">mrp_estimate_se =</span> <span class="fu">sd</span>(mrp_estimates)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table>
<thead>
<tr>
<th style="text-align:right;">
mrp_estimate
</th>
<th style="text-align:right;">
mrp_estimate_se
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3.339382
</td>
<td style="text-align:right;">
0.1588233
</td>
</tr>
</tbody>

</table>
</div>
</div>
<p>El resultado nos indica que el ingreso medio en el mpio 0111 es 3.34 lineas de pobreza</p>
</section>
<section id="estimación-para-segm-0111078" class="level3">
<h3 class="anchored" data-anchor-id="estimación-para-segm-0111078">Estimación para segm == “0111078”</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> poststrat_df <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">Posi =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(temp, segm <span class="sc">==</span> <span class="st">"0111078"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(n, Posi)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>n_filtered <span class="ot">&lt;-</span> temp<span class="sc">$</span>n</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>temp_epred_mat <span class="ot">&lt;-</span> epred_mat[, temp<span class="sc">$</span>Posi]</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimando el CME</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>mrp_estimates <span class="ot">&lt;-</span> temp_epred_mat <span class="sc">%*%</span> n_filtered <span class="sc">/</span> <span class="fu">sum</span>(n_filtered)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>(temp_ing <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">mrp_estimate =</span> <span class="fu">mean</span>(mrp_estimates),</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">mrp_estimate_se =</span> <span class="fu">sd</span>(mrp_estimates)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table>
<thead>
<tr>
<th style="text-align:right;">
mrp_estimate
</th>
<th style="text-align:right;">
mrp_estimate_se
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3.813232
</td>
<td style="text-align:right;">
0.4934149
</td>
</tr>
</tbody>

</table>
</div>
</div>
<p>El resultado nos indica que el ingreso medio en el segmento 0111078 es 3.81 lineas de pobreza</p>
<p>Después de comprender la forma en que se realiza la estimación de los dominios no observados procedemos el uso de la función <em>Aux_Agregado</em> que es desarrollada para este fin.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resultados nacionales ---------------------------------------------------</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>(mrp_estimate_Ingresolp <span class="ot">&lt;-</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Aux_Agregado</span>(<span class="at">poststrat =</span> poststrat_df,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">epredmat =</span> epred_mat,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">byMap =</span> <span class="cn">NULL</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table>
<thead>
<tr>
<th style="text-align:left;">
Nacional
</th>
<th style="text-align:right;">
mrp_estimate
</th>
<th style="text-align:right;">
mrp_estimate_se
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Nacional
</td>
<td style="text-align:right;">
5.402399
</td>
<td style="text-align:right;">
0.136384
</td>
</tr>
</tbody>

</table>
</div>
</div>
<p>El resultado nos indica que el ingreso medio nacional es 5 lineas de pobreza</p>
<p>De forma similar es posible obtener los resultados para mpio y segmento.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mrp_estimate_mpio <span class="ot">&lt;-</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Aux_Agregado</span>(<span class="at">poststrat =</span> poststrat_df,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">epredmat =</span> epred_mat,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">byMap =</span> <span class="st">"mpio"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Resultados para mpio</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> mpio </th>
   <th style="text-align:right;"> mrp_estimate </th>
   <th style="text-align:right;"> mrp_estimate_se </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0101 </td>
   <td style="text-align:right;"> 8.2621 </td>
   <td style="text-align:right;"> 0.3217 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0102 </td>
   <td style="text-align:right;"> 5.7249 </td>
   <td style="text-align:right;"> 0.3876 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0103 </td>
   <td style="text-align:right;"> 5.9599 </td>
   <td style="text-align:right;"> 0.2358 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0104 </td>
   <td style="text-align:right;"> 7.9584 </td>
   <td style="text-align:right;"> 0.2093 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0105 </td>
   <td style="text-align:right;"> 6.7482 </td>
   <td style="text-align:right;"> 0.2294 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0106 </td>
   <td style="text-align:right;"> 7.6477 </td>
   <td style="text-align:right;"> 0.2989 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0107 </td>
   <td style="text-align:right;"> 6.5022 </td>
   <td style="text-align:right;"> 0.2119 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0108 </td>
   <td style="text-align:right;"> 6.1616 </td>
   <td style="text-align:right;"> 0.3395 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0109 </td>
   <td style="text-align:right;"> 3.8982 </td>
   <td style="text-align:right;"> 0.2995 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0110 </td>
   <td style="text-align:right;"> 7.0972 </td>
   <td style="text-align:right;"> 0.1261 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0111 </td>
   <td style="text-align:right;"> 3.3394 </td>
   <td style="text-align:right;"> 0.1588 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0112 </td>
   <td style="text-align:right;"> 6.0467 </td>
   <td style="text-align:right;"> 0.1027 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0113 </td>
   <td style="text-align:right;"> 3.0117 </td>
   <td style="text-align:right;"> 0.1239 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0114 </td>
   <td style="text-align:right;"> 6.9044 </td>
   <td style="text-align:right;"> 0.2141 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0115 </td>
   <td style="text-align:right;"> 7.0500 </td>
   <td style="text-align:right;"> 0.1170 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0116 </td>
   <td style="text-align:right;"> 3.1084 </td>
   <td style="text-align:right;"> 0.3837 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0117 </td>
   <td style="text-align:right;"> 3.4005 </td>
   <td style="text-align:right;"> 0.1883 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0118 </td>
   <td style="text-align:right;"> 9.9616 </td>
   <td style="text-align:right;"> 0.1062 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0119 </td>
   <td style="text-align:right;"> 5.7589 </td>
   <td style="text-align:right;"> 0.2195 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0120 </td>
   <td style="text-align:right;"> 4.6825 </td>
   <td style="text-align:right;"> 0.1132 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0121 </td>
   <td style="text-align:right;"> 4.3291 </td>
   <td style="text-align:right;"> 0.1558 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0122 </td>
   <td style="text-align:right;"> 5.0868 </td>
   <td style="text-align:right;"> 0.1788 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0123 </td>
   <td style="text-align:right;"> 7.0901 </td>
   <td style="text-align:right;"> 0.1967 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0124 </td>
   <td style="text-align:right;"> 8.2059 </td>
   <td style="text-align:right;"> 0.0991 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0199 </td>
   <td style="text-align:right;"> 3.5670 </td>
   <td style="text-align:right;"> 0.2313 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>mrp_estimate_segmento <span class="ot">&lt;-</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Aux_Agregado</span>(<span class="at">poststrat =</span> poststrat_df,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">epredmat =</span> epred_mat,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">byMap =</span> <span class="st">"segm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Resultados para segmento</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> segm </th>
   <th style="text-align:right;"> mrp_estimate </th>
   <th style="text-align:right;"> mrp_estimate_se </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0101001 </td>
   <td style="text-align:right;"> 5.5350 </td>
   <td style="text-align:right;"> 0.9200 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0101002 </td>
   <td style="text-align:right;"> 8.7998 </td>
   <td style="text-align:right;"> 1.0474 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0101003 </td>
   <td style="text-align:right;"> 13.3890 </td>
   <td style="text-align:right;"> 1.3992 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0101104 </td>
   <td style="text-align:right;"> 4.9422 </td>
   <td style="text-align:right;"> 0.8148 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0101105 </td>
   <td style="text-align:right;"> 9.0977 </td>
   <td style="text-align:right;"> 0.5893 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0101204 </td>
   <td style="text-align:right;"> 4.7889 </td>
   <td style="text-align:right;"> 0.4282 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0101205 </td>
   <td style="text-align:right;"> 10.6395 </td>
   <td style="text-align:right;"> 0.5580 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0102001 </td>
   <td style="text-align:right;"> 4.4232 </td>
   <td style="text-align:right;"> 0.5094 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0102003 </td>
   <td style="text-align:right;"> 7.2110 </td>
   <td style="text-align:right;"> 0.9234 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0102004 </td>
   <td style="text-align:right;"> 6.1461 </td>
   <td style="text-align:right;"> 2.3755 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
</section>
<section id="algunos-mapas-resultantes" class="level2">
<h2 class="anchored" data-anchor-id="algunos-mapas-resultantes">Algunos mapas resultantes</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="5Modelo-unidad-ingresos_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Los espacios en blanco corresponden a segmento sin información auxiliar en la variable tasa de desocupación que fue extraída del censo.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="5Modelo-unidad-ingresos_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>